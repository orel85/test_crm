импорт Основное

@ВПроекте
конст КОД_БАЗОВОЙ_ВАЛЮТЫ = "RUB"

@Обработчик
метод ВычислитьРазрешенияДоступа(): Массив<РазрешениеДоступа>
    возврат [
        ПользователиКлиентИСервер.ПолныеПраваНаСправочникДляРуководителя(),
        новый РазрешениеДоступа(
            [новый КлючДоступаДляАутентифицированных.Объект()], 
            [Сущность.Право.Чтение])
    ]
;

@ВПроекте
метод ПолучитьВсе(): ЧитаемыйМассив<Валюты.Ссылка>
    знч МассивВалют = <Валюты.Ссылка>[]
    
    знч Запрос = Запрос{
        ВЫБРАТЬ
            Валюты.Ссылка КАК Ссылка
        ИЗ 
            Валюты КАК Валюты
        ГДЕ 
            Валюты.Код != %КОД_БАЗОВОЙ_ВАЛЮТЫ}
            
    для СтрокаРезультата из Запрос.Выполнить()
        МассивВалют.Добавить(СтрокаРезультата.Ссылка)
    ;
    
    возврат МассивВалют
;

@ВПроекте
метод ПолучитьБазовуюВалюту(): Валюты.Ссылка?
    знч Запрос = Запрос{
        ВЫБРАТЬ
            Валюты.Ссылка КАК Ссылка
        ИЗ 
            Валюты КАК Валюты
        ГДЕ 
            Валюты.Код == %КОД_БАЗОВОЙ_ВАЛЮТЫ}

    для СтрокаРезультата из Запрос.Выполнить()
        возврат СтрокаРезультата.Ссылка
    ;
    возврат Неопределено
;

@ВПроекте
метод СоздатьБазовуюВалюту()
    знч БазоваяВалюта = новый Валюты.Объект()
    БазоваяВалюта.Код = КОД_БАЗОВОЙ_ВАЛЮТЫ
    БазоваяВалюта.Наименование = "Рубль"
    БазоваяВалюта.Записать()
;
